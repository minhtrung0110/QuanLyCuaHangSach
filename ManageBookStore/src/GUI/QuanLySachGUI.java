
package GUI;
import BUS.NXBBUS;
import BUS.SachBUS;
import BUS.TacGiaBUS;
import BUS.TheLoaiBUS;
import BUS.ValidatorBUS;
import DTO.SachDTO;
import DAO.SachDAO;
import DTO.NXBDTO;
import DTO.TacGiaDTO;
import DTO.TheLoaiDTO;
import java.awt.*;
import java.awt.event.KeyEvent;
import java.awt.event.KeyListener;
import java.awt.image.BufferedImage;
import java.util.ArrayList;
import java.util.Vector;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.ImageIcon;
import javax.swing.JComboBox;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.table.DefaultTableModel;


public class QuanLySachGUI extends JPanel implements KeyListener {

    private int DEFALUT_WIDTH;
    private DefaultTableModel model;
    private NXBBUS nxbBUS =new NXBBUS();
    private TacGiaBUS tgBUS =new TacGiaBUS();
    private TheLoaiBUS tlBUS =new TheLoaiBUS();
    private boolean EditorAdd;
    private BufferedImage i = null;//Hình ảnh chọn từ file
    private JLabel img;
    private String imgName = "null";
    public QuanLySachGUI() {
        initComponents();
         this.setSize(1080, 750);
    }

    public QuanLySachGUI (int width) throws Exception
    {
        DEFALUT_WIDTH = width;
        initComponents();
       this.setSize(this.DEFALUT_WIDTH - 220, 750);
       ShowDataBase();
        LoadComboBox();
  
    }
    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jScrollPane1 = new javax.swing.JScrollPane();
        tbSach = new javax.swing.JTable();
        jSeparator1 = new javax.swing.JSeparator();
        jLabel13 = new javax.swing.JLabel();
        pButton = new javax.swing.JPanel();
        btThem = new javax.swing.JButton();
        btSua = new javax.swing.JButton();
        btXoa = new javax.swing.JButton();
        btHienThiTatCa = new javax.swing.JButton();
        pButton1 = new javax.swing.JPanel();
        btXacNhan = new javax.swing.JButton();
        btQuayLai = new javax.swing.JButton();
        btChonAnh = new javax.swing.JButton();
        pSearch = new javax.swing.JPanel();
        lbSearchMaSach = new javax.swing.JLabel();
        txSearchMaSach = new javax.swing.JTextField();
        lbSearchMaNXB = new javax.swing.JLabel();
        lbSearchMaTG = new javax.swing.JLabel();
        lbSearchTenSach = new javax.swing.JLabel();
        txSearchTenSach = new javax.swing.JTextField();
        btTimKiem = new javax.swing.JButton();
        cbSearchMaNXB = new javax.swing.JComboBox<>();
        cbSearchMaTG = new javax.swing.JComboBox<>();
        cbSearchMaTL = new javax.swing.JComboBox<>();
        lbSearchMATL = new javax.swing.JLabel();
        lbMin = new javax.swing.JLabel();
        txSearchMin = new javax.swing.JTextField();
        lbMax = new javax.swing.JLabel();
        txSearchMax = new javax.swing.JTextField();
        jLabel18 = new javax.swing.JLabel();
        lbSearchNamXuatBan = new javax.swing.JLabel();
        txSearchNamXuatBan = new javax.swing.JTextField();
        pInput = new javax.swing.JPanel();
        lbMaSach = new javax.swing.JLabel();
        lbMaNXB = new javax.swing.JLabel();
        lbMaTL = new javax.swing.JLabel();
        lbMaTG = new javax.swing.JLabel();
        lbTenSach = new javax.swing.JLabel();
        lbSoLuong = new javax.swing.JLabel();
        lbDonGia = new javax.swing.JLabel();
        txMaSach = new javax.swing.JTextField();
        cbMaNXB = new javax.swing.JComboBox<>();
        cbMaTL = new javax.swing.JComboBox<>();
        cbMaTG = new javax.swing.JComboBox<>();
        txTenSach = new javax.swing.JTextField();
        txSoLuong = new javax.swing.JTextField();
        txDonGia = new javax.swing.JTextField();
        lnNamXuatBan = new javax.swing.JLabel();
        txNamXuatBan = new javax.swing.JTextField();
        MainPanel = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();

        setBackground(new java.awt.Color(255, 255, 255));

        jScrollPane1.setBackground(new java.awt.Color(255, 255, 255));

        tbSach.setBorder(javax.swing.BorderFactory.createEtchedBorder(new java.awt.Color(0, 153, 51), new java.awt.Color(102, 102, 102)));
        tbSach.setFont(new java.awt.Font("Tahoma", 0, 13)); // NOI18N
        tbSach.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "MÃ SÁCH", "MÃ NXB", "MÃ TG", "MÃ TL", "TÊN SÁCH", "NĂM XUẤT BẢN", "SỐ LƯỢNG", "ĐƠN GIÁ"
            }
        ));
        tbSach.setGridColor(new java.awt.Color(211, 211, 211));
        tbSach.setSelectionBackground(new java.awt.Color(0, 153, 0));
        tbSach.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tbSachMouseClicked(evt);
            }
        });
        jScrollPane1.setViewportView(tbSach);
        if (tbSach.getColumnModel().getColumnCount() > 0) {
            tbSach.getColumnModel().getColumn(4).setPreferredWidth(200);
        }

        jSeparator1.setBackground(new java.awt.Color(0, 0, 102));
        jSeparator1.setForeground(new java.awt.Color(102, 102, 102));

        jLabel13.setBackground(new java.awt.Color(102, 255, 102));
        jLabel13.setForeground(new java.awt.Color(153, 153, 153));
        jLabel13.setIcon(new javax.swing.ImageIcon("D:\\Leanring\\Universe\\SecondYear\\HK2\\Java\\QuanLyCuaHangSach\\ManageBookStore\\src\\image\\profile01-250px.png")); // NOI18N
        jLabel13.setText("Ảnh");
        jLabel13.setToolTipText("");
        jLabel13.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED, new java.awt.Color(153, 153, 153), new java.awt.Color(204, 204, 204), new java.awt.Color(204, 204, 204), new java.awt.Color(204, 204, 204)));
        jLabel13.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));

        pButton.setBackground(new java.awt.Color(255, 255, 255));

        btThem.setBackground(new java.awt.Color(0, 0, 204));
        btThem.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        btThem.setForeground(new java.awt.Color(0, 0, 204));
        btThem.setText("THÊM");
        btThem.setBorder(new javax.swing.border.SoftBevelBorder(javax.swing.border.BevelBorder.RAISED, new java.awt.Color(153, 153, 153), new java.awt.Color(204, 204, 204), new java.awt.Color(153, 153, 153), new java.awt.Color(204, 204, 204)));
        btThem.setContentAreaFilled(false);
        btThem.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        btThem.setPreferredSize(new java.awt.Dimension(200, 43));
        btThem.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btThemActionPerformed(evt);
            }
        });

        btSua.setBackground(new java.awt.Color(255, 204, 0));
        btSua.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        btSua.setForeground(new java.awt.Color(255, 0, 0));
        btSua.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        btSua.setLabel("SỬA");
        btSua.setPreferredSize(new java.awt.Dimension(57, 31));
        btSua.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btSuaActionPerformed(evt);
            }
        });

        btXoa.setBackground(new java.awt.Color(255, 0, 0));
        btXoa.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        btXoa.setForeground(new java.awt.Color(255, 255, 255));
        btXoa.setText("XÓA");
        btXoa.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        btXoa.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btXoaActionPerformed(evt);
            }
        });

        btHienThiTatCa.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        btHienThiTatCa.setText("HIỂN THỊ TẤT CẢ");
        btHienThiTatCa.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        btHienThiTatCa.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btHienThiTatCaActionPerformed(evt);
            }
        });

        pButton1.setBackground(new java.awt.Color(255, 255, 255));

        btXacNhan.setBackground(new java.awt.Color(0, 0, 204));
        btXacNhan.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        btXacNhan.setForeground(new java.awt.Color(0, 0, 204));
        btXacNhan.setText("XÁC NHẬN");
        btXacNhan.setBorder(new javax.swing.border.SoftBevelBorder(javax.swing.border.BevelBorder.RAISED, new java.awt.Color(153, 153, 153), new java.awt.Color(204, 204, 204), new java.awt.Color(153, 153, 153), new java.awt.Color(204, 204, 204)));
        btXacNhan.setContentAreaFilled(false);
        btXacNhan.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        btXacNhan.setPreferredSize(new java.awt.Dimension(200, 43));
        btXacNhan.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btXacNhanActionPerformed(evt);
            }
        });

        btQuayLai.setBackground(new java.awt.Color(255, 204, 0));
        btQuayLai.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        btQuayLai.setForeground(new java.awt.Color(255, 0, 0));
        btQuayLai.setText("QUAY LẠI");
        btQuayLai.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        btQuayLai.setPreferredSize(new java.awt.Dimension(57, 31));

        btChonAnh.setBackground(new java.awt.Color(255, 0, 0));
        btChonAnh.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        btChonAnh.setForeground(new java.awt.Color(255, 255, 255));
        btChonAnh.setText("CHỌN ẢNH");
        btChonAnh.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        btChonAnh.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btChonAnhActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout pButton1Layout = new javax.swing.GroupLayout(pButton1);
        pButton1.setLayout(pButton1Layout);
        pButton1Layout.setHorizontalGroup(
            pButton1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pButton1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(pButton1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(btQuayLai, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(btXacNhan, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
                    .addComponent(btChonAnh, javax.swing.GroupLayout.DEFAULT_SIZE, 145, Short.MAX_VALUE))
                .addContainerGap(29, Short.MAX_VALUE))
        );
        pButton1Layout.setVerticalGroup(
            pButton1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pButton1Layout.createSequentialGroup()
                .addGap(22, 22, 22)
                .addComponent(btXacNhan, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(btQuayLai, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(12, 12, 12)
                .addComponent(btChonAnh, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(64, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout pButtonLayout = new javax.swing.GroupLayout(pButton);
        pButton.setLayout(pButtonLayout);
        pButtonLayout.setHorizontalGroup(
            pButtonLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pButtonLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(pButtonLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(btSua, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(btThem, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
                    .addComponent(btXoa, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(btHienThiTatCa, javax.swing.GroupLayout.DEFAULT_SIZE, 145, Short.MAX_VALUE))
                .addGap(18, 18, 18)
                .addComponent(pButton1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        pButtonLayout.setVerticalGroup(
            pButtonLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pButtonLayout.createSequentialGroup()
                .addGap(22, 22, 22)
                .addComponent(btThem, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(btSua, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(12, 12, 12)
                .addComponent(btXoa, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(btHienThiTatCa, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(44, Short.MAX_VALUE))
            .addGroup(pButtonLayout.createSequentialGroup()
                .addComponent(pButton1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, Short.MAX_VALUE))
        );

        pSearch.setBackground(new java.awt.Color(255, 255, 255));
        pSearch.setBorder(javax.swing.BorderFactory.createTitledBorder(javax.swing.BorderFactory.createEtchedBorder(new java.awt.Color(204, 204, 204), new java.awt.Color(204, 204, 204)), "Tìm Kiếm", javax.swing.border.TitledBorder.CENTER, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14), new java.awt.Color(0, 0, 153))); // NOI18N

        lbSearchMaSach.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        lbSearchMaSach.setText("MÃ SÁCH:");

        txSearchMaSach.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N

        lbSearchMaNXB.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        lbSearchMaNXB.setText("MÃ NXB:");

        lbSearchMaTG.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        lbSearchMaTG.setText("MÃ TG:");

        lbSearchTenSach.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        lbSearchTenSach.setText("TÊN SÁCH:");

        txSearchTenSach.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N

        btTimKiem.setBackground(new java.awt.Color(0, 0, 153));
        btTimKiem.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        btTimKiem.setForeground(new java.awt.Color(153, 153, 153));
        btTimKiem.setIcon(new javax.swing.ImageIcon("D:\\Leanring\\Universe\\SecondYear\\HK2\\Java\\QuanLyCuaHangSach\\ManageBookStore\\src\\image\\search_25px_focus.png")); // NOI18N
        btTimKiem.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        btTimKiem.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btTimKiemActionPerformed(evt);
            }
        });

        cbSearchMaNXB.addItem("Không");
        cbSearchMaNXB.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N

        cbSearchMaTG.addItem("Không");
        cbSearchMaTG.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N

        cbSearchMaTL.addItem("Không");
        cbSearchMaTL.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N

        lbSearchMATL.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        lbSearchMATL.setText("MÃ TL:");

        lbMin.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        lbMin.setText(" TỪ:");

        txSearchMin.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N

        lbMax.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        lbMax.setText("ĐẾN:");

        txSearchMax.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N

        jLabel18.setFont(new java.awt.Font("Times New Roman", 1, 12)); // NOI18N
        jLabel18.setForeground(new java.awt.Color(255, 0, 0));
        jLabel18.setText("KHOẢNG GIÁ");

        lbSearchNamXuatBan.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        lbSearchNamXuatBan.setText("NĂM XUẤT BẢN:");

        txSearchNamXuatBan.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        txSearchNamXuatBan.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txSearchNamXuatBanActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout pSearchLayout = new javax.swing.GroupLayout(pSearch);
        pSearch.setLayout(pSearchLayout);
        pSearchLayout.setHorizontalGroup(
            pSearchLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pSearchLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(pSearchLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(lbSearchMaSach)
                    .addGroup(pSearchLayout.createSequentialGroup()
                        .addGap(10, 10, 10)
                        .addComponent(lbSearchMaNXB)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(pSearchLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(cbSearchMaNXB, 0, 161, Short.MAX_VALUE)
                    .addComponent(txSearchMaSach))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(pSearchLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(lbSearchMaTG)
                    .addComponent(lbSearchMATL))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(pSearchLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(cbSearchMaTL, 0, 166, Short.MAX_VALUE)
                    .addComponent(cbSearchMaTG, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(pSearchLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(pSearchLayout.createSequentialGroup()
                        .addComponent(lbSearchNamXuatBan)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(txSearchNamXuatBan, javax.swing.GroupLayout.PREFERRED_SIZE, 152, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(14, 14, 14)
                        .addComponent(lbMin)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(txSearchMin, javax.swing.GroupLayout.PREFERRED_SIZE, 86, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(12, 12, 12)
                        .addComponent(lbMax)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(txSearchMax, javax.swing.GroupLayout.PREFERRED_SIZE, 81, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(pSearchLayout.createSequentialGroup()
                        .addComponent(lbSearchTenSach)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(txSearchTenSach, javax.swing.GroupLayout.PREFERRED_SIZE, 173, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(101, 101, 101)
                        .addComponent(jLabel18)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 30, Short.MAX_VALUE)
                .addComponent(btTimKiem, javax.swing.GroupLayout.PREFERRED_SIZE, 44, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(31, 31, 31))
        );
        pSearchLayout.setVerticalGroup(
            pSearchLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pSearchLayout.createSequentialGroup()
                .addGroup(pSearchLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(pSearchLayout.createSequentialGroup()
                        .addGroup(pSearchLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(lbSearchMaSach, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(txSearchMaSach, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(lbSearchMaTG, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(cbSearchMaTG, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(lbSearchTenSach, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(txSearchTenSach, javax.swing.GroupLayout.PREFERRED_SIZE, 26, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel18, javax.swing.GroupLayout.PREFERRED_SIZE, 22, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(pSearchLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(txSearchNamXuatBan, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addGroup(pSearchLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(lbSearchMaNXB, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(cbSearchMaNXB, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(lbSearchMATL, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(cbSearchMaTL, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(lbSearchNamXuatBan, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(lbMin, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(txSearchMin, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(lbMax, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(txSearchMax, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE))))
                    .addGroup(pSearchLayout.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(btTimKiem)))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        pInput.setBackground(new java.awt.Color(255, 255, 255));

        lbMaSach.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        lbMaSach.setText("MÃ SÁCH:");

        lbMaNXB.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        lbMaNXB.setText("MÃ NXB:");

        lbMaTL.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        lbMaTL.setText("MÃ THỂ LOẠI:");

        lbMaTG.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        lbMaTG.setText("MÃ TÁC GIẢ:");

        lbTenSach.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        lbTenSach.setText("TÊN SÁCH:");

        lbSoLuong.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        lbSoLuong.setText("SỐ LƯỢNG:");

        lbDonGia.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        lbDonGia.setText("ĐƠN GIÁ:");

        txMaSach.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N

        cbMaNXB.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        cbMaNXB.addItem(" ");
        cbMaNXB.addKeyListener(this);
        cbMaNXB.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cbMaNXBActionPerformed(evt);
            }
        });

        cbMaTL.addItem(" ");
        cbMaTL.addKeyListener(this);
        cbMaTL.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N

        cbMaTG.addItem(" ");
        cbMaTG.addKeyListener(this);
        cbMaTG.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N

        txTenSach.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N

        txSoLuong.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N

        txDonGia.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N

        lnNamXuatBan.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        lnNamXuatBan.setText("NĂM XUẤT BẢN:");

        txNamXuatBan.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N

        javax.swing.GroupLayout pInputLayout = new javax.swing.GroupLayout(pInput);
        pInput.setLayout(pInputLayout);
        pInputLayout.setHorizontalGroup(
            pInputLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pInputLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(pInputLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(pInputLayout.createSequentialGroup()
                        .addGroup(pInputLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(lbDonGia, javax.swing.GroupLayout.PREFERRED_SIZE, 72, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addGroup(pInputLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                .addComponent(lbSoLuong, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addComponent(lbTenSach, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addComponent(lbMaTG, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
                        .addGap(10, 10, 10)
                        .addGroup(pInputLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(cbMaTG, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 223, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(txTenSach, javax.swing.GroupLayout.PREFERRED_SIZE, 223, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(txSoLuong, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 223, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(txDonGia, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 223, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addGroup(pInputLayout.createSequentialGroup()
                        .addGroup(pInputLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(lbMaSach, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(lbMaNXB, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(lbMaTL, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(pInputLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(txMaSach, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 223, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(cbMaNXB, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 223, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(cbMaTL, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 223, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addGroup(pInputLayout.createSequentialGroup()
                        .addComponent(lnNamXuatBan, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addGap(10, 10, 10)
                        .addComponent(txNamXuatBan, javax.swing.GroupLayout.PREFERRED_SIZE, 223, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap())
        );
        pInputLayout.setVerticalGroup(
            pInputLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, pInputLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(pInputLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lbMaSach, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txMaSach, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(pInputLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lbMaNXB, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(cbMaNXB, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(pInputLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lbMaTL, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(cbMaTL, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(pInputLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lbMaTG, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(cbMaTG, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(pInputLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lbTenSach, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txTenSach, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(pInputLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lnNamXuatBan, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txNamXuatBan, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 8, Short.MAX_VALUE)
                .addGroup(pInputLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lbSoLuong, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txSoLuong, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(pInputLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lbDonGia, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txDonGia, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)))
        );

        MainPanel.setBackground(new java.awt.Color(255, 255, 255));

        jLabel1.setFont(new java.awt.Font("Times New Roman", 1, 24)); // NOI18N
        jLabel1.setForeground(new java.awt.Color(255, 0, 0));
        jLabel1.setText("QUẢN LÝ SÁCH");

        javax.swing.GroupLayout MainPanelLayout = new javax.swing.GroupLayout(MainPanel);
        MainPanel.setLayout(MainPanelLayout);
        MainPanelLayout.setHorizontalGroup(
            MainPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, MainPanelLayout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(jLabel1, javax.swing.GroupLayout.PREFERRED_SIZE, 189, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(441, 441, 441))
        );
        MainPanelLayout.setVerticalGroup(
            MainPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jLabel1, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 37, javax.swing.GroupLayout.PREFERRED_SIZE)
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(MainPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addComponent(jSeparator1)
            .addComponent(pSearch, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addGroup(layout.createSequentialGroup()
                .addGap(50, 50, 50)
                .addComponent(pInput, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(32, 32, 32)
                .addComponent(pButton, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(jLabel13, javax.swing.GroupLayout.PREFERRED_SIZE, 200, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(24, 24, 24))
            .addGroup(layout.createSequentialGroup()
                .addGap(18, 18, 18)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 1038, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(20, Short.MAX_VALUE))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addComponent(MainPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(pInput, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(layout.createSequentialGroup()
                        .addGap(34, 34, 34)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel13, javax.swing.GroupLayout.PREFERRED_SIZE, 199, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(pButton, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(pSearch, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jSeparator1, javax.swing.GroupLayout.PREFERRED_SIZE, 2, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 349, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );
    }// </editor-fold>//GEN-END:initComponents
    public void insertHeader(){
        Vector header = new Vector();
        header.add("MÃ SÁCH");
        header.add("MÃ NXB");
        header.add("MÃ TÁC GIẢ");
        header.add("MÃ THỂ LOẠI");
        header.add("TÊN SÁCH");
        header.add("NĂM XUẤT BẢN");
        header.add("SỐ LƯỢNG");
        header.add("ĐƠN GIÁ");
        //if (model.getRowCount()==0)
              model=new DefaultTableModel(header,0);
           
    }
    public void outModel(DefaultTableModel model ,ArrayList<SachDTO> sach) // Xuất ra Table từ ArrayList
    {
        Vector data;
        model.setRowCount(0);
        for(SachDTO s: sach)
        {
            data = new Vector();
            data.add(s.getMaSach());
            data.add(s.getMaNXB());
            data.add(s.getMaTL());
            data.add(s.getMaTG());
            data.add(s.getTenSach());
            data.add(s.getNamXuatBan());
            data.add(s.getSoluong());
            data.add(s.getDongia());
            model.addRow(data);
        }
        tbSach.setModel(model);
    }

    private void ShowDataBase() throws Exception{       
        try {
            SachBUS bus =new SachBUS();
        if(SachBUS.getListSach()==null) bus.loadDSSach();
        insertHeader();
        outModel(model,SachBUS.getListSach());
        } catch (Exception e) {
            JOptionPane.showMessageDialog(this,"Không Thể Load Database ", "Thông Báo Lỗi",JOptionPane.ERROR_MESSAGE);
        }
        
    }
    private void btTimKiemActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btTimKiemActionPerformed
        
    }//GEN-LAST:event_btTimKiemActionPerformed

    private void btThemActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btThemActionPerformed
       try {
             // Validate
              StringBuilder sb =new StringBuilder();
            ValidatorBUS.checkEmpty(txMaSach, sb, "Mã Sách Còn Trống!");
            ValidatorBUS.checkEmpty(cbMaNXB, sb, "Mã Nhà Xuất Bản Còn Trống!");
            ValidatorBUS.checkEmpty(cbMaTG, sb, "Mã Tác Giả Còn Trống!");
            ValidatorBUS.checkEmpty(cbMaTL, sb, "Mã Thể Loại Còn Trống!");
            ValidatorBUS.checkEmpty(txTenSach, sb, "Tên Sách Còn Trống!");
            ValidatorBUS.checkSoLuong(txNamXuatBan, sb, "Năm Xuất Bản Còn Trống !");
            ValidatorBUS.checkSoLuong(txSoLuong, sb, "Số Lượng Là Số Nguyên !");
            ValidatorBUS.checkDonGia(txDonGia, sb, "Đơn Giá là Số !");
             if(sb.length()>0){
                JOptionPane.showMessageDialog(this,sb.toString(), "Thông Báo Lỗi Nhập",JOptionPane.ERROR_MESSAGE);
                    return ;
                 }
            SachDTO sach=new SachDTO();
            sach.setMaSach(txMaSach.getText());
            sach.setMaNXB((String)cbMaNXB.getSelectedItem());
            sach.setMaTG((String)cbMaTG.getSelectedItem());
            sach.setMaTL((String)cbMaTL.getSelectedItem());
            sach.setTenSach(txTenSach.getText());
            sach.setNamXuatBan(Integer.parseInt(txNamXuatBan.getText()));
            sach.setSoluong(Integer.parseInt(txSoLuong.getText()));
            sach.setDongia(Float.parseFloat(txDonGia.getText()));
            sach.setImgName("src/dc");// dể tam dể sau này thêm Ảnh ở đây
            SachBUS bus =new SachBUS();
            bus.addSach(sach);

            this.insertHeader();
            this.outModel(model,SachBUS.getListSach());    
            
        } catch (Exception ex) {
            JOptionPane.showMessageDialog(this,"Lỗi Thêm Sách ", "Thông Báo Lỗi",JOptionPane.ERROR_MESSAGE);
         }
       
    }//GEN-LAST:event_btThemActionPerformed

    private void txSearchNamXuatBanActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txSearchNamXuatBanActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txSearchNamXuatBanActionPerformed

    private void tbSachMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tbSachMouseClicked
      
        int i = tbSach.getSelectedRow();
            if(i>=0)
            {   
               /* if(tbSach.getRowSorter() != null)
                {
                    i = tbSach.getRowSorter().convertRowIndexToModel(i);
                }
                imgName = tbSach.getModel().getValueAt(i, 7).toString();
                Image newImage ;
                try{
                    newImage = new ImageIcon("./src/image/Sach/"+imgName).getImage().getScaledInstance(200, 200, Image.SCALE_DEFAULT);
                }catch(NullPointerException E)
                {
                    newImage = new ImageIcon("./src/image/Sach/NoImage.jpg").getImage().getScaledInstance(200, 200, Image.SCALE_DEFAULT); 
                }*/
                txMaSach.setText(tbSach.getModel().getValueAt(i, 0).toString());
                cbMaNXB.setSelectedItem(nxbBUS.searchMaNXB(tbSach.getModel().getValueAt(i, 1).toString()));
                cbMaTG.setSelectedItem(tgBUS.searchMaTG(tbSach.getModel().getValueAt(i, 2).toString()));
                cbMaTL.setSelectedItem(tlBUS.searchMaTL(tbSach.getModel().getValueAt(i, 3).toString()));
                txTenSach.setText( tbSach.getModel().getValueAt(i, 4).toString());
                txNamXuatBan.setText( tbSach.getModel().getValueAt(i, 5).toString());
                txSoLuong.setText( tbSach.getModel().getValueAt(i, 6).toString());
                txDonGia.setText( tbSach.getModel().getValueAt(i, 7).toString());
                //img.setText("");
                //img.setIcon(new ImageIcon(newImage));
            }  
    }//GEN-LAST:event_tbSachMouseClicked

    private void btXacNhanActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btXacNhanActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_btXacNhanActionPerformed

    private void btChonAnhActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btChonAnhActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_btChonAnhActionPerformed

    private void btXoaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btXoaActionPerformed
        int  i=tbSach.getSelectedRow();
        if (i>=0)
        {
            int k = JOptionPane.showConfirmDialog(null, "Bạn Thực Sự Muốn Xóa Sách Này ?","Thông Báo",JOptionPane.YES_NO_OPTION);
            if(k == 0){
                String idSach=txMaSach.getText();
                 try {
                       SachBUS bus =new SachBUS();
                       bus.deleteSach(idSach);
                 } catch (Exception e) {
                       JOptionPane.showMessageDialog(this, "Lỗi Không Thể Xóa","Thông Báo Lỗi",JOptionPane.ERROR_MESSAGE);
                    }
                 model.removeRow(i);
                 tbSach.setModel(model);
            }
        }
    }//GEN-LAST:event_btXoaActionPerformed

    private void cbMaNXBActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cbMaNXBActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_cbMaNXBActionPerformed

    private void btSuaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btSuaActionPerformed
       int  i=tbSach.getSelectedRow();// i bắ t đầu từ 0
        if (i>=0)
        {
            try{
                      StringBuilder sb =new StringBuilder();
            ValidatorBUS.checkEmpty(txMaSach, sb, "Mã Sách Còn Trống!");
            ValidatorBUS.checkEmpty(cbMaNXB, sb, "Mã Nhà Xuất Bản Còn Trống!");
            ValidatorBUS.checkEmpty(cbMaTG, sb, "Mã Tác Giả Còn Trống!");
            ValidatorBUS.checkEmpty(cbMaTL, sb, "Mã Thể Loại Còn Trống!");
            ValidatorBUS.checkEmpty(txTenSach, sb, "Tên Sách Còn Trống!");
            ValidatorBUS.checkSoLuong(txNamXuatBan, sb, "Năm Xuất Bản Còn Trống !");
            ValidatorBUS.checkSoLuong(txSoLuong, sb, "Số Lượng Là Số Nguyên !");
            ValidatorBUS.checkDonGia(txDonGia, sb, "Đơn Giá là Số !");
             if(sb.length()>0){
                JOptionPane.showMessageDialog(this,sb.toString(), "Thông Báo Lỗi Nhập",JOptionPane.ERROR_MESSAGE);
                    return ;
                 }

                SachDTO sach=new SachDTO();
                sach.setMaSach(txMaSach.getText());
                sach.setMaNXB(cbMaNXB.getSelectedItem().toString());
                sach.setMaTG(cbMaTG.getSelectedItem().toString());
                sach.setMaTL(cbMaTL.getSelectedItem().toString());
                sach.setTenSach(txTenSach.getText());
                sach.setNamXuatBan(Integer.parseInt(txNamXuatBan.getText()));
                sach.setSoluong(Integer.parseInt(txSoLuong.getText()));
                sach.setDongia(Float.parseFloat(txDonGia.getText()));
                sach.setImgName("/src/imges/");
                SachBUS bus =new SachBUS();
                bus.updateSach(sach);
                
                model.setValueAt(sach.getMaSach(), i, 0);
                model.setValueAt(sach.getMaNXB(), i, 1);
                model.setValueAt(sach.getMaTG(), i, 2);  
                model.setValueAt(sach.getMaTL(), i, 3);
                model.setValueAt(sach.getTenSach(), i, 4);
                model.setValueAt(sach.getNamXuatBan(), i, 5);
                model.setValueAt(sach.getSoluong(), i, 6); 
                model.setValueAt(sach.getDongia(), i, 7); 
            tbSach.setModel(model);
            } catch (Exception ex) {
                JOptionPane.showMessageDialog(this,"Không Thể Sửa Sách", "Thông Báo Lỗi",JOptionPane.ERROR_MESSAGE);
            }
        } 
    }//GEN-LAST:event_btSuaActionPerformed

    private void btHienThiTatCaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btHienThiTatCaActionPerformed
       tbSach.setModel(model);
    }//GEN-LAST:event_btHienThiTatCaActionPerformed
    public void LoadComboBox() throws Exception{
        listNXB(cbMaNXB);
        listTG(cbMaTG);
        listTL(cbMaTL);
        listNXB(cbSearchMaNXB);
        listTG(cbSearchMaTG);
        listTL(cbSearchMaTL);
        
    }
    public void listNXB(JComboBox cmb) throws Exception
    {
        if(nxbBUS.getlistNXB()== null) nxbBUS.loadDSNXB();
        ArrayList<NXBDTO> nxb = nxbBUS.getlistNXB();
        for(NXBDTO a : nxb){
            cmb.addItem(a.getMaNXB());
        }
      
    }
    public void listTL(JComboBox cmb) throws Exception
    {
        if(tlBUS.getListTheLoai()== null) tlBUS.loadDSTheLoai();
        ArrayList<TheLoaiDTO> tl = tlBUS.getListTheLoai();
        for(TheLoaiDTO a : tl){
            cmb.addItem(a.getMaTL());
        }
      
    }
    public void listTG(JComboBox cmb) throws Exception
    {
        if(tgBUS.getListTacGia()== null) tgBUS.loadDSTacGia();
        ArrayList<TacGiaDTO> tg = tgBUS.getListTacGia();
        for(TacGiaDTO  a: tg){
            cmb.addItem(a.getMaTG());
        }
      
    }
    public void addCombo(JComboBox cmb,ArrayList<Object> list)
    {
        for(Object a:list)
        {
            cmb.addItem(a);
            
        }
       
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JPanel MainPanel;
    private javax.swing.JButton btChonAnh;
    private javax.swing.JButton btHienThiTatCa;
    private javax.swing.JButton btQuayLai;
    private javax.swing.JButton btSua;
    private javax.swing.JButton btThem;
    private javax.swing.JButton btTimKiem;
    private javax.swing.JButton btXacNhan;
    private javax.swing.JButton btXoa;
    private javax.swing.JComboBox<String> cbMaNXB;
    private javax.swing.JComboBox<String> cbMaTG;
    private javax.swing.JComboBox<String> cbMaTL;
    private javax.swing.JComboBox<String> cbSearchMaNXB;
    private javax.swing.JComboBox<String> cbSearchMaTG;
    private javax.swing.JComboBox<String> cbSearchMaTL;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel13;
    private javax.swing.JLabel jLabel18;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JSeparator jSeparator1;
    private javax.swing.JLabel lbDonGia;
    private javax.swing.JLabel lbMaNXB;
    private javax.swing.JLabel lbMaSach;
    private javax.swing.JLabel lbMaTG;
    private javax.swing.JLabel lbMaTL;
    private javax.swing.JLabel lbMax;
    private javax.swing.JLabel lbMin;
    private javax.swing.JLabel lbSearchMATL;
    private javax.swing.JLabel lbSearchMaNXB;
    private javax.swing.JLabel lbSearchMaSach;
    private javax.swing.JLabel lbSearchMaTG;
    private javax.swing.JLabel lbSearchNamXuatBan;
    private javax.swing.JLabel lbSearchTenSach;
    private javax.swing.JLabel lbSoLuong;
    private javax.swing.JLabel lbTenSach;
    private javax.swing.JLabel lnNamXuatBan;
    private javax.swing.JPanel pButton;
    private javax.swing.JPanel pButton1;
    private javax.swing.JPanel pInput;
    private javax.swing.JPanel pSearch;
    private javax.swing.JTable tbSach;
    private javax.swing.JTextField txDonGia;
    private javax.swing.JTextField txMaSach;
    private javax.swing.JTextField txNamXuatBan;
    private javax.swing.JTextField txSearchMaSach;
    private javax.swing.JTextField txSearchMax;
    private javax.swing.JTextField txSearchMin;
    private javax.swing.JTextField txSearchNamXuatBan;
    private javax.swing.JTextField txSearchTenSach;
    private javax.swing.JTextField txSoLuong;
    private javax.swing.JTextField txTenSach;
    // End of variables declaration//GEN-END:variables

    @Override
    public void keyTyped(KeyEvent e) {
        throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    }

    @Override
    public void keyPressed(KeyEvent e) {
        Object a = e.getSource();
        if(a.equals(cbSearchMaTG) || a.equals(cbSearchMaTL) || a.equals(cbSearchMaNXB) || a.equals(txSearchMaSach) 
                || a.equals(txSearchTenSach) || a.equals(txSearchMin) || a.equals(txSearchMax)
                || a.equals(txSearchNamXuatBan) /*|| a.equals(txSearchMin)*/ )
        {
            if(e.getKeyCode() == KeyEvent.VK_ENTER)
            {
                //Search();
            }
        }    }

    @Override
    public void keyReleased(KeyEvent e) {
        throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    }
}
